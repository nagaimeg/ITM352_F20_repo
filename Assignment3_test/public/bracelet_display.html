<!--Author: Meghan Nagai-->
<!--followed getting started with Assignment1 html copied SmartPhoneProducts 3 and w3 template-->
<!--code adjusted from Assignment 1 to fit Assignment 3-->
<!--referenced Justina Bui-->

<script src="./products_data.js" type="text/javascript"></script>
<script> var product_key ="Bracelets"; </script>
<script>

  //Functions copied from order_page.html from Lab13
  function checkQuantityTextbox(theTextbox) {
    errs = isNonNegInt(theTextbox.value, true);
    document.getElementById(theTextbox.name + '_message').innerHTML = errs.join(", ");
  }

  function isNonNegInt(q, returnErrors = false) {
    errors = []; // assume no errors at first
    if (q == '') { q = 0; }//Check if there is a blank. If there is, it is a zero
    if (Number(q) != q) errors.push('Not a number!'); // Check if string is a number value
    if (q < 0) errors.push('Negative value!'); // Check if it is non-negative
    if (parseInt(q) != q) errors.push(' Not an integer!'); // Check that it is an integer
    return returnErrors ? errors : (errors.length == 0);
  }

    // Example POST method implementation:
    async function postData(url = '', data = {}) {

// Default options are marked with *
const response = await fetch(url, {
    method: 'POST', // *GET, POST, PUT, DELETE, etc.
    headers: {
        'Accept': 'application/json',
        'Content-Type': 'application/json'
    },
    body: JSON.stringify(data) // body data type must match "Content-Type" header
});
return response.json(); // parses JSON response into native JavaScript objects
}

function add_to_cart(i) {
postData('./add_to_cart', { 'product_key': product_key, 'product_index': i, 'quantity': document.getElementById('quantity' + i).value })
    .then(data => {
        console.log(data);
        document.getElementById(`quantity${i}_span`).innerHTML = data.message;
        document.getElementById(`quantity${i}`).value = 0;
    });
}
</script>

<!DOCTYPE html>
<html>
<title>Meghan's Diamond Necklace Store</title>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<!--link to style sheet template from the w3schools templates-->
<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Karma">
<!--Setting the font for the document-->
<style>
  body,
  h1,
  h2,
  h3,
  h4,
  h5,
  h6 {
    font-family: "Karma", sans-serif
  }

  .w3-bar-block .w3-bar-item {
    padding: 20px
  }

  /*format the navigation bar*/
  nav {
    padding-top: 100px;
    text-align: center;
  }
</style>
<!--setting the background image to be the starry.jpg-->

<body style="background-image: url(images/starry.jpg);  background-repeat: no-repeat; background-size:cover;">

  <!--navigation bar-->
  <nav>
    <a href="./index.html"><img src="images/home.png" height="200px" width="200px"></a>
    <a href="./necklace_display.html"><img src="images/necklaces.png" height="200px" width="200px"></a>
    <a href="./earring_display.html"><img src="images/earrings.png" height="200px" width="200px"></a>
    <a href="./ring_display.html"><img src="images/rings.png" height="200px" width="200px"></a>
    <a href="./login"><img src="images/login.png" height="200px" width="200px"></a>
    <a href="./cart.html"><img src="images/cart.png" height="200px" width="200px"></a>
  </nav>

  <!-- Formatting the Top menu from w3 schools template -->
  <div class="w3-top">
    <div class="w3-white w3-xlarge" style="max-width:1200px;margin:auto; ">
      <div class="w3-center w3-padding-16" style="background-color: palevioletred">Diamond Bracelets for the Perfect
        Gem!</div>
    </div>
  </div>

  <!--what to do with the form-->
  <form name="product_form" action="/process_form" method="POST">

    <!-- !PAGE CONTENT! from w3 schools template -->
    <div class="w3-main w3-content w3-padding" style="max-width:1200px;margin-top:100px;">
      <script>
        for (i = 0; i < bracelets.length; i++) {
          document.write(`    
    <!-- First Photo Grid and formatt the image size-->
    <!--Display the products, brand, product name, and price-->
    <div class="w3-row-padding w3-padding-16 w3-center" style="background-color:pink">
        <img src="${bracelets[i]['image']}"style="width:300px; height: 300px;>
      <div style="width=300px">
      <h2>${bracelets[i]['brand']}</h2>
        <p>${bracelets[i]['product_name']}</p>
        <p>$${bracelets[i]['price']}</p>
      <label>Quantity:</label>
            <input type ="text" name="quantity${i}" onkeyup="checkQuantityTextbox(this);">
            <span id="quantity${i}_message">Enter a quantity</span></p>

            `)
        }
      </script>
    </div>
    <!--format the purchase button-->
    <input type="submit" value="Add to Cart"
      style="height:100px; width:300px; margin:auto 0; text-align: center; background-color: palevioletred; font-size: 35px;  font-weight: 700;"
      name="submit_button">
  </form>
  </div>
  <h1>
    <footer>Make life shiny!</footer>
  </h1>
</body>

</html>